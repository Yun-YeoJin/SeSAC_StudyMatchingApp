
# ğŸŒ±Â SeSAC Study  - ë‚´ ìœ„ì¹˜ ê¸°ë°˜ : ë§¤ì¹­ ì±„íŒ…ì•±

<img width="923" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-12-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5 53 41" src="https://user-images.githubusercontent.com/106153549/208381402-63b76e30-06a1-4761-8478-d5cbd7c2dc82.png">
<img width="600" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-12-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_6 05 03" src="https://user-images.githubusercontent.com/106153549/208381906-8b220c54-3312-4ef6-b562-e4f58120dc24.png">



ğŸŒ±Â ìƒˆì‹¹ iOS ì•± ê°œë°œì ê³¼ì • ë‘ ë²ˆì§¸ í”„ë¡œì íŠ¸ SeSAC Study ì…ë‹ˆë‹¤.

- **ë‚´ ìœ„ì¹˜ì™€ ê³µë¶€í•˜ê³  ì‹¶ì€ ìŠ¤í„°ë””ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì£¼ë³€ ì‚¬ìš©ìì™€ ë§¤ì¹­ í›„ ì±„íŒ…ê¹Œì§€ ì´ì–´ì§€ëŠ” ì±„íŒ…ì•±**
    - ë¡œê·¸ì¸ ë° íšŒì›ê°€ì…
        - ì²˜ìŒ ì ‘ì† í–ˆì„ ì‹œ OnBoarding í™”ë©´
        - FireBaseAuthë¥¼ ì´ìš©í•œ íœ´ëŒ€í° ë¬¸ì ì¸ì¦, ë¡œê·¸ì¸, íšŒì›ê°€ì…
            - ë¬¸ì ì¸ì¦ â†’ ë¡œê·¸ì¸ ì‹œ ê°€ì…ì •ë³´ ìœ ë¬´ì— ë”°ë¥¸ í™”ë©´ ì „í™˜
            - íšŒì›ê°€ì…ì€ ë‹‰ë„¤ì„, ìƒë…„ì›”ì¼, ì´ë©”ì¼, ì„±ë³„ ì„¤ì •
    - ë‚´ ì •ë³´ ê´€ë¦¬
        - ë‚´ ì •ë³´ ê´€ë¦¬ ìˆ˜ì •ìœ¼ë¡œ ë‹‰ë„¤ì„, ì„±ë³„, ë‚´ ë²ˆí˜¸ ê²€ìƒ‰ê°€ëŠ¥, ì—°ë ¹ëŒ€ ì„¤ì •, íšŒì›íƒˆí‡´
            - Custom CardViewì™€ ScrollViewë¥¼ ì´ìš©í•œ í™”ë©´ êµ¬í˜„
            - MultiSliderë¥¼ ì´ìš©í•œ ìŠ¬ë¼ì´ë” êµ¬í˜„
            - íšŒì›íƒˆí‡´ì‹œ CustomAlertì„ ì´ìš©í•´ ë¬¸êµ¬ ë„ì›Œì£¼ê¸°
            - íƒˆí‡´ ì„±ê³µì‹œ â†’ ë¬¸ì ì¸ì¦ í™”ë©´ìœ¼ë¡œ ì´ë™ (RootView ë³€ê²½)
    - í™ˆ í™”ë©´
        - MapKitê³¼ CLLocationì„ ì´ìš©í•œ ì§€ë„ ì‚¬ìš©
            - CustomAnnotaionì„ ì´ìš©í•´ ì£¼ë³€ ì¹œêµ¬ë“¤ í‘œì‹œ
            - ì „ì²´ / ë‚¨ì„± / ì—¬ì„± í•„í„°ë§ êµ¬í˜„
        - ë‚´ê°€ í•˜ê³  ì‹¶ì€ ìŠ¤í„°ë”” ì„¤ì • í›„ ì¹œêµ¬ ì°¾ê¸°
    - ì±„íŒ… í™”ë©´
        - ì£¼ë³€ ì¹œêµ¬ / ë°›ì€ ìš”ì²­ ëª©ë¡ í™•ì¸ í›„ ì±„íŒ… êµ¬í˜„
            - ì±„íŒ… ìš”ì²­ ë³´ë‚´ê¸°, ìˆ˜ë½, ê±°ì ˆ
            - ë§¤ì¹­í•œ ì¹œêµ¬ì™€ 1:1 ì‹¤ì‹œê°„ ì±„íŒ…
        - ë§¤ì¹­í–ˆë˜ ì¹œêµ¬ ì‹ ê³ , ìŠ¤í„°ë”” ì·¨ì†Œ, ì±„íŒ…ì— ëŒ€í•œ ë¦¬ë·° ì‘ì„± êµ¬í˜„
    - Confluenceë¥¼ í†µí•œ ê¸°íš / API ëª…ì„¸ì„œ í™•ì¸
    - Swaggerë¥¼ ì´ìš©í•œ API MOCK ë°ì´í„° í™•ì¸
    - Figmaë¥¼ í†µí•œ UI ë””ìì¸ ëª…ì„¸ì„œ í™•ì¸ ë° ì ìš©

## **ê°œë°œ ê¸°ê°„ ë° ì‚¬ìš© ê¸°ìˆ **

- ê°œë°œ ê¸°ê°„: 2022.11.07 ~ 2022.12.15 (ì•½ 5ì£¼) - ê¸°íšì•ˆ í™•ì¸, ì•± ê°œë°œ
- ì‚¬ìš© ê¸°ìˆ :
    - í™”ë©´ êµ¬í˜„ : Swift, UIKit, SnapKit, Then, Tabman, MultiSlider
    - ë„¤íŠ¸ì›Œí¬ í†µì‹  : Alamofire, RxAlamofire, Router, URLConvertible
    - DB : RealmSwift
    - Rx : RxSwift, RxCocoa, RxKeyboard, RxdataSource
    - ê¸°íƒ€ : FireBaseAuth, FCM, Toast, SocketIO
    - ë””ìì¸íŒ¨í„´ : MVVM
    

## **ìƒˆë¡œ ë°°ìš´ ê²ƒ**

- RxAlamofire, Router, URLConvertibleë¥¼ ì´ìš©í•œ ë¹„ë™ê¸° API í†µì‹  ë° ë°ì´í„° ì²˜ë¦¬
    - ìì²´ ì„œë²„ API ì´ìš©
- MVVM íŒ¨í„´ì˜ ì´í•´ ë° ì ìš©
- RxSwiftì— ëŒ€í•œ ì´í•´ ë° ì ìš©
- RxSwift Input / Outputì„ ì´ìš©í•œ MVVM ì•„í‚¤í…ì²˜
- WebSocketIOì„ ì´ìš©í•œ ì‹¤ì‹œê°„ ì±„íŒ…
- CustomViewë¥¼ ì´ìš©í•œ View ì¬ì‚¬ìš©
- Confluence, Figmaë¥¼ ì´ìš©í•œ ê¸°íšì„œ í™•ì¸
- Swaggerë¥¼ ì´ìš©í•œ API MOCK Data í™•ì¸
- FireBaseAuthë¥¼ ì´ìš©í•œ ë¬¸ì ì¸ì¦ ë° ë¡œê·¸ì¸
- MapKit, CoreLocationì„ ì´ìš©í•œ AppleMap ì‚¬ìš©

## ğŸ’¡**Trouble Shooting**

- FireBaseAuthë¥¼ ì´ìš©í•œ ë¬¸ì ì¸ì¦ ì‹œ â†’ í† í° ê°±ì‹  ì‹œì  ê³ ë¯¼
    - ë¬¸ìì¸ì¦ í›„ ë¡œê·¸ì¸ í•  ë•Œ IDTokenì´ ì—†ë‹¤ë©´ ê°±ì‹ í•´ì£¼ì—ˆë‹¤.

```swift
func checkValidate(verificationNumber: String, completion: @escaping (VerifyNumberAuthStatus) -> Void) {
        
        let credential = PhoneAuthProvider.provider().credential(withVerificationID: UserDefaults.standard.string(forKey: "authVerificationID") ?? "", verificationCode: verificationNumber)
        
        Auth.auth().signIn(with: credential) { success, error in
            if let error = error { ... }
            
            let currentUser = Auth.auth().currentUser
            currentUser?.getIDTokenForcingRefresh(true, completion: { idToken, error in
                if let error = error {
                    completion(.unknownError)
                    return;
                }
                UserDefaultsRepository.saveIDToken(idToken: idToken ?? "")
                completion(.success)
            })
        }
    }
```

- Firebase ì˜¤ë¥˜ â†’ íšŒì›íƒˆí‡´ í›„ íšŒì›ê°€ì…ì„ ìœ„í•œ íœ´ëŒ€í° ì¸ì¦ì‹œ ì—ëŸ¬
    - StackOverFlowì—ì„œ ì°¾ì§€ ëª»í•œ ë‚´ìš©ì´ë¼ì„œ FireBase ê³µì‹ë¬¸ì„œë¥¼ ì°¾ì•„ì„œ í•´ê²°
    - `The UIApplicationDelegate must handle remote notification for phone number authentication to work.`

```swift
//AppDelegateì— ë„£ì–´ì„œ í•´ê²°í•¨.
func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {
        
        Auth.auth().setAPNSToken(deviceToken, type: .prod)
        
    }
```

- íšŒì›íƒˆí‡´ í›„ í™”ë©´ ì „í™˜ ê¸°ëŠ¥ êµ¬í˜„ ì´ìŠˆ (rootView ì •í•´ì£¼ê¸°)
    - SceneDelegateì—ì„œ rootViewë¥¼ ì •í•´ì£¼ê³ , í™”ë©´ ì „í™˜ì‹œ rootView ìˆ˜ì •í•˜ê¸°.

```swift
**//ViewController**
			self.viewModel.withdrawUser { message, code in
                let windowScene = UIApplication.shared.connectedScenes.first as? UIWindowScene
                let sceneDelegate = windowScene?.delegate as? SceneDelegate
                switch code {
                case .success:
                    let vc = Login1ViewController()
                    sceneDelegate?.window?.rootViewController = vc
                    sceneDelegate?.window?.makeKeyAndVisible()
                default:
                    self.view.makeToast("íšŒì›íƒˆí‡´ì— ì‹¤íŒ¨í–ˆì–´ìš”.")
                }
            }
```

- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ ë°”ë¡œ ì „ í™”ë©´ì´ ì•„ë‹Œ ì›í•˜ëŠ” í™”ë©´ìœ¼ë¡œ Pop ê¸°ëŠ¥ì´ìŠˆ

```swift
**//extension UIViewController**		
func navigationPopToViewController<T: UIViewController>(_ vc: T) {
        let viewControllers: [UIViewController] = self.navigationController!.viewControllers as [UIViewController]

        for viewController in viewControllers {
            if let rootVC = viewController as? T {
                self.navigationController?.popToViewController(rootVC, animated: true)
            }
        }
    }
```

- ìƒë…„ì›”ì¼ DatePicker ë§Œ 17ì„¸ ì´ìƒ ë²„íŠ¼ í™œì„±í™” - dateComponentsë¥¼ ì´ìš©

```swift
**//ViewModel**
func checkValidDate(date: Date) -> Bool {
        
	 inputDate.date = date
	 birth.value = date
        
	 let yearCheck = Calendar.current.dateComponents([.year], from: inputDate.date!, to: today.date!).year ?? 0
        
   return yearCheck >= 17
}

```

- Mapkitê³¼ CLLocationì„ ì´ìš©í•œ CustomAnnotaion ì„¤ì • ì´ìŠˆ

```swift
func mapView(_ mapView: MKMapView, viewFor annotation: MKAnnotation) -> MKAnnotationView? {
        
        guard let annotation = annotation as? CustomAnnotation else {return nil}
        guard let annotationView = mainView.mapKit.dequeueReusableAnnotationView(withIdentifier: CustomAnnotationView.identifier) as? CustomAnnotationView else { return nil }
        annotationView.annotation = annotation
        
        let size = CGSize(width: 95, height: 95)
        UIGraphicsBeginImageContext(size)
        
        let image = UIImage.sesacImage(num: annotation.image ?? 0)
        image.draw(in: CGRect(x: 0, y: 0, width: size.width, height: size.height))
        
        let resizedImage = UIGraphicsGetImageFromCurrentImageContext()
        annotationView.image = resizedImage
        UIGraphicsEndImageContext()
        return annotationView
    }

func setRegionAnnotation(center: CLLocationCoordinate2D, users: [SeSACUser]) {
        
        let region = MKCoordinateRegion(center: CLLocationCoordinate2D(latitude: 37.517819364682694, longitude: 126.88647317074734), latitudinalMeters: 700, longitudinalMeters: 700)
        mainView.mapKit.removeAnnotations(mainView.mapKit.annotations)
        mainView.mapKit.setRegion(region, animated: false)

        var annotation: [CustomAnnotation] = []
        
        for user in users {
            let point = CustomAnnotation(image: user.sesac, coordinate: CLLocationCoordinate2D(latitude: user.lat, longitude: user.long))
            annotation.append(point)
        }
        mainView.mapKit.addAnnotations(annotation)
    }

```

- ë‚´ ì •ë³´ ê´€ë¦¬ì—ì„œ ScrollView ì´ìŠˆ â†’ ScrollView ë‚´ì— ContentsView ì—†ì´ ë ˆì´ì•„ì›ƒì„ ì¡ê²Œë˜ë©´ ScrollView ë‚´ë¶€ì˜ í¬ê¸°ë¥¼ ì œëŒ€ë¡œ ì¡ì§€ ëª»í•´ì„œ Scrollì´ ë˜ì§€ ì•ŠëŠ” ì´ìŠˆê°€ ë°œìƒ â†’ ScrollViewì˜ ê³µì‹ë¬¸ì„œ, ë¸”ë¡œê·¸ë“±ìœ¼ë¡œ ì°¾ì•„ì„œ ì´í•´í•˜ê³  ì ìš©
    - ScrollViewì•ˆì— ë“¤ì–´ê°€ëŠ” ContentsViewê°€ ScrollViewì— ì œì•½ ì¡°ê±´ì„ ê±¸ì–´ì•¼ í•œë‹¤.
    - ContentsViewë¥¼ equalToSuperView()ì— ì œì•½ì¡°ê±´ì„ ê±¸ë©´ ìŠ¤í¬ë¡¤ì´ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.

```swift

		let scrollView = UIScrollView()
    let cardView = CardView()
    let stackView = UIStackView()

    func setConstraints() {
        
        scrollView.snp.makeConstraints { make in
            make.edges.equalTo(self)
        }
        
        cardView.snp.makeConstraints { make in
            make.top.equalTo(scrollView)
            make.leading.equalTo(scrollView).inset(16)
            make.trailing.equalTo(scrollView).inset(16)
            make.height.greaterThanOrEqualTo(252)
            make.width.equalTo(UIScreen.main.bounds.width - 32)
        }
        
        stackView.snp.makeConstraints { make in
            make.top.equalTo(cardView.snp.bottom).offset(10)
            make.leading.equalTo(scrollView).inset(16)
            make.trailing.equalTo(scrollView).inset(16)
            make.bottom.equalTo(scrollView)
        }
				... 
```

## **UI**

<img width="652" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-12-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5 51 46" src="https://user-images.githubusercontent.com/106153549/208381632-f3416667-8c64-450b-bc6f-82f975edee99.png">
<img width="865" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-12-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5 51 52" src="https://user-images.githubusercontent.com/106153549/208381713-2e81410b-37e7-40c6-8832-f81d368fa07b.png">
<img width="645" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-12-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5 51 37" src="https://user-images.githubusercontent.com/106153549/208381990-331a9c93-2d9f-48b5-be72-c9217b09a097.png">
<img width="864" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-12-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5 51 31" src="https://user-images.githubusercontent.com/106153549/208382020-f06d3b76-2f48-41b9-9fbb-de2b35ffba5b.png">
<img width="251" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-12-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5 51 21" src="https://user-images.githubusercontent.com/106153549/208382033-9715653f-dae5-4403-8c87-7a1f7ab2b7c3.png">
<img width="912" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-12-15_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_6 06 29" src="https://user-images.githubusercontent.com/106153549/208382108-4eca2010-ba21-4556-89d1-c630f59f6d04.png">
